**Problem up09-1: up09-1**

Язык L задается с помощью грамматики:

    S = aXPQ
    P = YXP | ε
    Q = UVQ | ε
    aY = aa
    aU = a0
    0U = 00
    0X = 0b
    bX = bb
    bV = b1
    1V = 11
    XY = YX
    UY = YU
    VY = YV
    XU = UX
    VU = UV
    VX = XV

Нетерминальные символы обозначаются заглавными буквами, а терминальные символы — строчными буквами и цифрами. Начальный нетерминал — S.

На стандартном потоке подаются строки, разделяющиеся пробельными символами. Для каждой строки на стандартный поток вывода напечатайте 1, если строка принадлежит языку, и 0 в противном случае.

Указание: определите тип языка и преобразуйте грамматику к соответствующему типу. Грамматику запишите в комментарии в начале программы.

**Problem up09-2: up09-2**

Дан язык L, порождаемый следующей грамматикой:

    S → C0 | C1
    A → A0 | A1 | 0 | 1
    B → A1 | 1
    C → B0 | B1

На стандартном потоке подаются строки, разделяющиеся пробельными символами. Для каждой строки на стандартный поток вывода напечатайте 1, если строка принадлежит языку, и 0 в противном случае.

Для анализа строк используйте лексический анализатор (конечный автомат).

**Problem up09-3: up09-3**

На вход подается описание грамматики в следующем виде: каждое правило состоит из двух символьных строк, разделяемых произвольным количеством пробельных символов. Грамматика представляет собой последовательность правил. Таким образом, на вход подается четное число строк, разделяемых произвольным количеством пробельных символов.

В строках допускаются:

 - Заглавные латинские буквы, обозначающие нетерминалы.
 - Строчные латинские буквы и цифры, обозначающие терминалы.
 - Символ подчеркивания, обозначающий пустую правую часть (эпсилон).
 - Символ подчеркивания может находится только в правой части правила, в этом случае он является единственным символом в правой части.

Начальный нетерминал грамматики всегда 'S'.

Гарантируется, что входная грамматика — контекстно-свободная (в том числе укорачивающая), то есть удовлетворяет правилам, описанным в задаче 'is-context-free'.

На стандартный поток вывода напечатайте:

 - 2 если грамматика является контекстно-свободной, но не неукорачивающей контекстно-свободной и не регулярной.
 - 21 если грамматика является неукорачивающей контестно-свободной, но не является регулярной.
 - 31 если грамматика является леволинейной регулярной грамматикой, но не является левоавтоматной
 - 311 если грамматика является левоавтоматной грамматикой
 - 32 если грамматика является праволинейной регулярной грамматикой, но не является правоавтоматной
 - 321 если грамматика являеся правоавтоматной грамматикой

В случае неоднозначности выводите меньший номер.

В леволинейной или праволинейной грамматике в правой части правил допускается произвольное (в том числе нулевое) количество терминальных символов. В лево- или право-автоматной грамматике в правой части правил всегда должен присутствовать ровно один терминал. Но в автоматной грамматике в качестве исключения допускаются два правила для вывода пустой цепочки из S вида:

    S _
    S A

В этом случае грамматика со стартовым нетерминалом A должна быть автоматной в строгом смысле, а нетерминал S не должен использоваться в правых частях правил.

Examples

Input  
S abS  
S ceA  
A zA  
A b  
      
Output  
32  

**Problem up09-4: up09-4**

Язык `L1 = { a^n b^m c^m d^n | m, n > 0 }.` Для данного целого числа k (0 < k < 1000) напечатайте все строки длины k, принадлежащие данному языку, в лексикографическом порядке. Запоминать строки в памяти не допускается. Использование вспомогательных переменных не допускается. Каждую строку выводите на отдельной строке текста.

Решение реализуйте с помощью рекурсивного спуска, добавляя вместо проверки входной строки генерацию выходной строки. В начале решения напишите грамматику для данного языка, допускающую рекурсивный спуск.

Вы можете использовать одну переменную для чтения входного параметра. Рекурсивные функции могут принимать не более двух целых параметров: входной параметр и дополнительный параметр генерации.

Examples  

Input  
4  

Output  
abcd  

**Problem up09-5: up09-5**

На вход подается описание КС-грамматики в следующем формате:

    <левая часть> <правая часть>

где <...> – строки, состоящие из цифр, строчных и заглавных латинских символов, а также символа ‘_’, означающего пустую цепочку (эпсилон).

Строчные символы и цифры – терминальные (из Т).
Заглавные – нетерминальные (из N).
Правила грамматики задаются не в сокращенной форме.

На выходе программа должна вывести:
правила эквивалентной грамматики без недостижимых символов не в сокращенной форме.

Пример  

Вход  
S a  
S Bc  
D e
  
Выход    
S a  
S Bc  

**Problem up09-6: up09-6**

Напишите программу, моделирующую работу детерминированного конечного автомата (ДКА). Описание автомата и входная строка вводятся на стандартном потоке ввода. Результат работы автомата над данной строкой выводится на стандартный поток вывода.

Описание автомата задаётся в следующей форме. Сначала задаётся функция перехода автомата. Функция перехода задаётся в виде троек

    CUR CHAR NEW

где `CUR` — идентификатор исходного состояния — произвольная символьная строка, не содержащая пробельные символы. `CHAR` — символьная строка длиной ровно 1 символ. `NEW` — идентификатор целевого состояния — произвольная символьная строка, не содержащая пробельные символы. Элементы описания перехода могут отделятся друг от друга произвольным количеством пробельных символов. Описание функции перехода завершается строкой `END` в качестве идентификатора исходного состояния. Элементы `CHAR` и `NEW` отсутствуют.

Далее перечисляются заключительные состояния автомата. Каждое состояние — это символьная строка. Список состояний завершается символьной строкой `END`.

Далее задаётся начальное состояние автомата — символьная строка. Затем задаётся проверяемое слово — символьная строка. Все элементы входного файла могут отделяться друг от друга произвольным количеством пробельных символов.

Можете предполагать, что входные данные корректны, то есть удовлетворяют спецификации и действительно задают детерминированный конечный автомат.

Результат работы автомата должен быть напечатан в следующем виде. Сначала напечатайте число 1, если данный автомат допускает данную цепочку, и 0 в противном случае. Затем напечатайте количество символов, прочитанных во входной цепочке к моменту принятия автоматом решения (текущий символ не считается прочитанным). Наконец, напечатайте идентификатор состояния, в котором в данный момент находился автомат.

Examples  

Input  
A a A  
A b B  
B a C  
B b B  
C a C  
END  
B C END  
A  
aaabbbbba  

Output  
1  
9  
C  

Input  
A a A  
A b B  
B a C  
B b B  
C a C  
END  
B C END  
A  
abab  

Output  
0  
3  
C 
